<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Study Tracker - Compete with Friends</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Login/Register Screen -->
    <div id="authScreen" class="screen active">
        <div class="auth-container">
            <h1>üìö Study Tracker</h1>
            <p class="tagline">Compete with friends while you learn!</p>
            
            <div class="auth-form">
                <input type="text" id="usernameInput" placeholder="Enter your username" />
                <input type="text" id="userIdInput" placeholder="Your unique ID (auto-generated)" readonly />
                <button onclick="login()" class="btn-primary">Start Learning</button>
            </div>
        </div>
    </div>

    <!-- Main Dashboard -->
    <div id="dashboardScreen" class="screen">
        <nav class="navbar">
            <div class="nav-brand">üìö Study Tracker</div>
            <div class="nav-user">
                <span id="navUsername"></span>
                <span class="user-id">ID: <span id="navUserId"></span></span>
                <span class="points-badge" id="navPoints">0 pts</span>
                <button onclick="logout()" class="btn-logout">Logout</button>
            </div>
        </nav>

        <div class="dashboard-container">
            <!-- Sidebar -->
            <aside class="sidebar">
                <button class="menu-btn active" onclick="showSection('chapters')">
                    üìñ My Chapters
                </button>
                <button class="menu-btn" onclick="showSection('friends')">
                    üë• Friends
                </button>
                <button class="menu-btn" onclick="showSection('leaderboard')">
                    üèÜ Leaderboard
                </button>
                <button class="menu-btn" onclick="showSection('stats')">
                    üìä My Stats
                </button>
            </aside>

            <!-- Main Content -->
            <main class="main-content">
                <!-- Chapters Section -->
                <section id="chaptersSection" class="content-section active">
                    <div class="section-header">
                        <h2>My Chapters</h2>
                        <button onclick="openAddChapterModal()" class="btn-primary">+ Add Chapter</button>
                    </div>

                    <div class="chapters-grid" id="chaptersGrid">
                        <div class="empty-state">
                            <p>üìö No chapters yet. Add your first chapter to start earning points!</p>
                        </div>
                    </div>
                </section>

                <!-- Friends Section -->
                <section id="friendsSection" class="content-section">
                    <div class="section-header">
                        <h2>Friends</h2>
                        <button onclick="openAddFriendModal()" class="btn-primary">+ Add Friend</button>
                    </div>

                    <div class="friends-list" id="friendsList">
                        <div class="empty-state">
                            <p>üë• No friends added yet. Add friends to compete!</p>
                        </div>
                    </div>
                </section>

                <!-- Leaderboard Section -->
                <section id="leaderboardSection" class="content-section">
                    <div class="section-header">
                        <h2>üèÜ Leaderboard</h2>
                    </div>

                    <div class="leaderboard" id="leaderboard">
                        <div class="empty-state">
                            <p>Add friends to see the leaderboard!</p>
                        </div>
                    </div>
                </section>

                <!-- Stats Section -->
                <section id="statsSection" class="content-section">
                    <div class="section-header">
                        <h2>üìä My Statistics</h2>
                    </div>

                    <div class="stats-container">
                        <div class="stats-cards">
                            <div class="stat-card">
                                <div class="stat-value" id="totalChapters">0</div>
                                <div class="stat-label">Total Chapters</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="completedChapters">0</div>
                                <div class="stat-label">Completed</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="totalPoints">0</div>
                                <div class="stat-label">Total Points</div>
                            </div>
                        </div>

                        <div class="chart-tabs">
                            <button class="chart-tab active" onclick="switchChart('day')">Day</button>
                            <button class="chart-tab" onclick="switchChart('week')">Week</button>
                            <button class="chart-tab" onclick="switchChart('month')">Month</button>
                        </div>

                        <div class="chart-container">
                            <canvas id="pointsChart"></canvas>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- Add Chapter Modal -->
    <div id="addChapterModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New Chapter</h3>
                <span class="close" onclick="closeAddChapterModal()">&times;</span>
            </div>
            <div class="modal-body">
                <input type="text" id="chapterName" placeholder="Chapter name" />
                <textarea id="chapterDescription" placeholder="Description (optional)" rows="3"></textarea>
                <button onclick="addChapter()" class="btn-primary">Add Chapter</button>
            </div>
        </div>
    </div>

    <!-- Quiz Modal -->
    <div id="quizModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Chapter Checkpoint</h3>
            </div>
            <div class="modal-body">
                <p class="quiz-question">Have you completed this chapter?</p>
                <div class="quiz-options">
                    <label class="quiz-option">
                        <input type="radio" name="completed" value="yes" />
                        <span>‚úÖ Yes, I've completed it</span>
                    </label>
                    <label class="quiz-option">
                        <input type="radio" name="completed" value="no" />
                        <span>‚ùå No, still working on it</span>
                    </label>
                </div>
                <button onclick="submitQuiz()" class="btn-primary">Submit</button>
                <button onclick="closeQuizModal()" class="btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Add Friend Modal -->
    <div id="addFriendModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Friend</h3>
                <span class="close" onclick="closeAddFriendModal()">&times;</span>
            </div>
            <div class="modal-body">
                <input type="text" id="friendId" placeholder="Enter friend's ID" />
                <button onclick="addFriend()" class="btn-primary">Add Friend</button>
            </div>
        </div>
    </div>

    <!-- Success Toast -->
    <div id="toast" class="toast"></div>

    <!-- Firebase SDK -->
    <script type="module">
        // Import Firebase modules
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';
        import { getDatabase, ref, set, get, update, onValue, child } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js';

        // Firebase configuration
        // YOU NEED TO REPLACE THIS WITH YOUR OWN FIREBASE CONFIG
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
            databaseURL: "https://YOUR_PROJECT_ID-default-rtdb.firebaseio.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT_ID.appspot.com",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // Make database available globally
        window.db = database;
        window.dbRef = ref;
        window.dbSet = set;
        window.dbGet = get;
        window.dbUpdate = update;
        window.dbOnValue = onValue;
        window.dbChild = child;
    </script>
    
    <script src="script.js"></script>
</body>
</html>
